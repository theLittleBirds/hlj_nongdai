<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nongyeos.loan.admin.mapper.BusIntoPieceMapper" >

    <resultMap id="BaseResultMap" type="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        <id column="id" property="id" jdbcType="VARCHAR" />
        <result column="model_id" property="modelId" jdbcType="VARCHAR" />
        <result column="org_id" property="orgId" jdbcType="VARCHAR" />
        <result column="product" property="product" jdbcType="VARCHAR" />
        <result column="name" property="name" jdbcType="VARCHAR" />
        <result column="credit_capital" property="creditCapital" jdbcType="DECIMAL" />
        <result column="capital" property="capital" jdbcType="DECIMAL" />
        <result column="term" property="term" jdbcType="INTEGER" />
        <result column="use" property="use" jdbcType="INTEGER" />
        <result column="use_remark" property="useRemark" jdbcType="VARCHAR" />
        <result column="member_id" property="memberId" jdbcType="VARCHAR" />
        <result column="member_name" property="memberName" jdbcType="VARCHAR" />
        <result column="sex" property="sex" jdbcType="INTEGER" />
        <result column="age" property="age" jdbcType="INTEGER" />
        <result column="id_card" property="idCard" jdbcType="VARCHAR" />
        <result column="phone" property="phone" jdbcType="VARCHAR" />
        <result column="bank" property="bank" jdbcType="VARCHAR" />
        <result column="bank_card_no" property="bankCardNo" jdbcType="VARCHAR" />
        <result column="address" property="address" jdbcType="VARCHAR" />
        <result column="education_level" property="educationLevel" jdbcType="INTEGER" />
        <result column="marital_status" property="maritalStatus" jdbcType="INTEGER" />
        <result column="duty" property="duty" jdbcType="VARCHAR" />
        <result column="nonfarm_com_name" property="nonfarmComName" jdbcType="VARCHAR" />
        <result column="nonfarm_com_address" property="nonfarmComAddress" jdbcType="VARCHAR" />
        <result column="nonfarm_com_phone" property="nonfarmComPhone" jdbcType="VARCHAR" />
        <result column="trial_by" property="trialBy" jdbcType="VARCHAR" />
        <result column="trial_name" property="trialName" jdbcType="VARCHAR" />
        <result column="trial_date" property="trialDate" jdbcType="TIMESTAMP" />
        <result column="trial_opinion" property="trialOpinion" jdbcType="VARCHAR" />
        <result column="review_by" property="reviewBy" jdbcType="VARCHAR" />
        <result column="review_name" property="reviewName" jdbcType="VARCHAR" />
        <result column="review_date" property="reviewDate" jdbcType="TIMESTAMP" />
        <result column="review_opinion" property="reviewOpinion" jdbcType="VARCHAR" />
        <result column="last_by" property="lastBy" jdbcType="VARCHAR" />
        <result column="last_name" property="lastName" jdbcType="VARCHAR" />
        <result column="last_date" property="lastDate" jdbcType="TIMESTAMP" />
        <result column="last_opinion" property="lastOpinion" jdbcType="VARCHAR" />
        <result column="service_fee_way" property="serviceFeeWay" jdbcType="INTEGER" />
        <result column="member_info_checking" property="memberInfoChecking" jdbcType="INTEGER" />
        <result column="family_record_summary" property="familyRecordSummary" jdbcType="VARCHAR" />
        <result column="asset_checking" property="assetChecking" jdbcType="VARCHAR" />
        <result column="asset" property="asset" jdbcType="VARCHAR" />
        <result column="type" property="type" jdbcType="INTEGER" />
        <result column="order_status" property="orderStatus" jdbcType="INTEGER" />
        <result column="channel" property="channel" jdbcType="VARCHAR" />
        <result column="lender_id" property="lenderId" jdbcType="VARCHAR" />
        <result column="report_id" property="reportId" jdbcType="VARCHAR" />
        <result column="oper_user_id" property="operUserId" jdbcType="VARCHAR" />
        <result column="IS_DELETED" property="isDeleted" jdbcType="TINYINT" />
        <result column="CRE_OPER_ID" property="creOperId" jdbcType="VARCHAR" />
        <result column="CRE_OPER_NAME" property="creOperName" jdbcType="VARCHAR" />
        <result column="CRE_ORG_ID" property="creOrgId" jdbcType="VARCHAR" />
        <result column="CRE_DATE" property="creDate" jdbcType="TIMESTAMP" />
        <result column="UPD_OPER_ID" property="updOperId" jdbcType="VARCHAR" />
        <result column="UPD_OPER_NAME" property="updOperName" jdbcType="VARCHAR" />
        <result column="UPD_ORG_ID" property="updOrgId" jdbcType="VARCHAR" />
        <result column="UPD_DATE" property="updDate" jdbcType="TIMESTAMP" />
        <result column="product_settle_price" property="productSettlePrice" jdbcType="VARCHAR" />
        <result column="product_price" property="productPrice" jdbcType="VARCHAR" />
        <result column="product_list_info" property="productListInfo" jdbcType="LONGVARCHAR" />
        <result column="recieve_nong_zi" property="recieveNongZi" jdbcType="VARCHAR" />
        <result column="recieve_cash" property="recieveCash" jdbcType="VARCHAR" />
    </resultMap>
    
    <resultMap id="ExportResultMap" type="hashmap" >
        <id column="id" property="id" jdbcType="VARCHAR" />
        <result column="member_name" property="memberName" jdbcType="VARCHAR" />
        <result column="sex" property="sex" jdbcType="INTEGER" />
        <result column="age" property="age" jdbcType="INTEGER" />
        <result column="id_card" property="idCard" jdbcType="VARCHAR" />
        <result column="phone" property="phone" jdbcType="VARCHAR" />
        <result column="bank" property="bank" jdbcType="VARCHAR" />
        <result column="bank_card_no" property="bankCardNo" jdbcType="VARCHAR" />
        <result column="education_level" property="educationLevel" jdbcType="INTEGER" />
        <result column="marital_status" property="maritalStatus" jdbcType="INTEGER" />
        <result column="repayment_type" property="repaymentType" jdbcType="INTEGER" />
        <result column="capital" property="capital" jdbcType="DECIMAL" />
        <result column="term" property="term" jdbcType="INTEGER" />
        <result column="address" property="address" jdbcType="VARCHAR" />
        <result column="use_remark" property="useRemark" jdbcType="VARCHAR" />
        <result column="credit_capital" property="creditCapital" jdbcType="DECIMAL" />
    </resultMap>


    <sql id="Base_Column_List" >
        id, model_id, org_id, product, name, credit_capital, capital, term, `use`, use_remark, 
        member_id, member_name, sex, age, id_card, phone, bank, bank_card_no, address, education_level, 
        marital_status, duty, nonfarm_com_name, nonfarm_com_address, nonfarm_com_phone, trial_by, 
        trial_name, trial_date, trial_opinion, review_by, review_name, review_date, review_opinion, 
        last_by, last_name, last_date, last_opinion,service_fee_way, member_info_checking, family_record_summary, 
        asset_checking, asset, type, order_status, channel, lender_id, report_id, oper_user_id, IS_DELETED, 
        CRE_OPER_ID, CRE_OPER_NAME, CRE_ORG_ID, CRE_DATE, UPD_OPER_ID, UPD_OPER_NAME, UPD_ORG_ID, 
        UPD_DATE,product_settle_price,product_price,product_list_info,recieve_nong_zi,recieve_cash
    </sql>

    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
        select 
        <include refid="Base_Column_List" />
        from t_bus_intopiece
        where id = #{id,jdbcType=VARCHAR}
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
        delete from t_bus_intopiece
        where id = #{id,jdbcType=VARCHAR}
    </delete>



    <insert id="insert" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        insert into t_bus_intopiece (id, model_id, org_id, 
            product, name, credit_capital, 
            capital, term, `use`, 
            use_remark, member_id, member_name, 
            sex, age, id_card, 
            phone, bank, bank_card_no, 
            address, education_level, marital_status, 
            duty, nonfarm_com_name, nonfarm_com_address, 
            nonfarm_com_phone, trial_by, trial_name, 
            trial_date, trial_opinion, review_by, 
            review_name, review_date, review_opinion, 
            last_by, last_name, last_date, 
            last_opinion,service_fee_way, member_info_checking, family_record_summary, 
            asset_checking, asset, type, order_status,
            channel, lender_id, report_id, 
            oper_user_id, IS_DELETED, CRE_OPER_ID, 
            CRE_OPER_NAME, CRE_ORG_ID, CRE_DATE, 
            UPD_OPER_ID, UPD_OPER_NAME, UPD_ORG_ID, 
            UPD_DATE,product_settle_price,product_price,product_list_info,recieve_nong_zi,recieve_cash)
        values (#{id,jdbcType=VARCHAR}, #{modelId,jdbcType=VARCHAR}, #{orgId,jdbcType=VARCHAR}, 
            #{product,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{creditCapital,jdbcType=DECIMAL}, 
            #{capital,jdbcType=DECIMAL}, #{term,jdbcType=INTEGER}, #{use,jdbcType=INTEGER}, 
            #{useRemark,jdbcType=VARCHAR}, #{memberId,jdbcType=VARCHAR}, #{memberName,jdbcType=VARCHAR}, 
            #{sex,jdbcType=INTEGER}, #{age,jdbcType=INTEGER}, #{idCard,jdbcType=VARCHAR}, 
            #{phone,jdbcType=VARCHAR}, #{bank,jdbcType=VARCHAR}, #{bankCardNo,jdbcType=VARCHAR}, 
            #{address,jdbcType=VARCHAR}, #{educationLevel,jdbcType=INTEGER}, #{maritalStatus,jdbcType=INTEGER}, 
            #{duty,jdbcType=VARCHAR}, #{nonfarmComName,jdbcType=VARCHAR}, #{nonfarmComAddress,jdbcType=VARCHAR}, 
            #{nonfarmComPhone,jdbcType=VARCHAR}, #{trialBy,jdbcType=VARCHAR}, #{trialName,jdbcType=VARCHAR}, 
            #{trialDate,jdbcType=TIMESTAMP}, #{trialOpinion,jdbcType=VARCHAR}, #{reviewBy,jdbcType=VARCHAR}, 
            #{reviewName,jdbcType=VARCHAR}, #{reviewDate,jdbcType=TIMESTAMP}, #{reviewOpinion,jdbcType=VARCHAR}, 
            #{lastBy,jdbcType=VARCHAR}, #{lastName,jdbcType=VARCHAR}, #{lastDate,jdbcType=TIMESTAMP}, 
            #{lastOpinion,jdbcType=VARCHAR},#{serviceFeeWay,jdbcType=INTEGER}, #{memberInfoChecking,jdbcType=INTEGER}, #{familyRecordSummary,jdbcType=VARCHAR}, 
            #{assetChecking,jdbcType=VARCHAR}, #{asset,jdbcType=VARCHAR}, #{type,jdbcType=INTEGER}, #{orderStatus,jdbcType=INTEGER},
            #{channel,jdbcType=VARCHAR}, #{lenderId,jdbcType=VARCHAR}, #{reportId,jdbcType=VARCHAR}, 
            #{operUserId,jdbcType=VARCHAR}, #{isDeleted,jdbcType=TINYINT}, #{creOperId,jdbcType=VARCHAR}, 
            #{creOperName,jdbcType=VARCHAR}, #{creOrgId,jdbcType=VARCHAR}, #{creDate,jdbcType=TIMESTAMP}, 
            #{updOperId,jdbcType=VARCHAR}, #{updOperName,jdbcType=VARCHAR}, #{updOrgId,jdbcType=VARCHAR}, 
            #{updDate,jdbcType=TIMESTAMP},#{productSettlePrice,jdbcType=VARCHAR},#{productPrice,jdbcType=VARCHAR},#{productListInfo,jdbcType=LONGVARCHAR}
            ,#{recieveNongZi,jdbcType=VARCHAR},#{recieveCash,jdbcType=VARCHAR})
    </insert>

    <insert id="insertSelective" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        insert into t_bus_intopiece
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="modelId != null" >
                model_id,
            </if>
            <if test="orgId != null" >
                org_id,
            </if>
            <if test="product != null" >
                product,
            </if>
            <if test="name != null" >
                name,
            </if>
            <if test="creditCapital != null" >
                credit_capital,
            </if>
            <if test="capital != null" >
                capital,
            </if>
            <if test="term != null" >
                term,
            </if>
            <if test="use != null" >
                `use`,
            </if>
            <if test="useRemark != null" >
                use_remark,
            </if>
            <if test="memberId != null" >
                member_id,
            </if>
            <if test="memberName != null" >
                member_name,
            </if>
            <if test="sex != null" >
                sex,
            </if>
            <if test="age != null" >
                age,
            </if>
            <if test="idCard != null" >
                id_card,
            </if>
            <if test="phone != null" >
                phone,
            </if>
            <if test="bank != null" >
                bank,
            </if>
            <if test="bankCardNo != null" >
                bank_card_no,
            </if>
            <if test="address != null" >
                address,
            </if>
            <if test="educationLevel != null" >
                education_level,
            </if>
            <if test="maritalStatus != null" >
                marital_status,
            </if>
            <if test="duty != null" >
                duty,
            </if>
            <if test="nonfarmComName != null" >
                nonfarm_com_name,
            </if>
            <if test="nonfarmComAddress != null" >
                nonfarm_com_address,
            </if>
            <if test="nonfarmComPhone != null" >
                nonfarm_com_phone,
            </if>
            <if test="trialBy != null" >
                trial_by,
            </if>
            <if test="trialName != null" >
                trial_name,
            </if>
            <if test="trialDate != null" >
                trial_date,
            </if>
            <if test="trialOpinion != null" >
                trial_opinion,
            </if>
            <if test="reviewBy != null" >
                review_by,
            </if>
            <if test="reviewName != null" >
                review_name,
            </if>
            <if test="reviewDate != null" >
                review_date,
            </if>
            <if test="reviewOpinion != null" >
                review_opinion,
            </if>
            <if test="lastBy != null" >
                last_by,
            </if>
            <if test="lastName != null" >
                last_name,
            </if>
            <if test="lastDate != null" >
                last_date,
            </if>
            <if test="lastOpinion != null" >
                last_opinion,
            </if>
            <if test="serviceFeeWay != null" >
                service_fee_way,
            </if>
            <if test="memberInfoChecking != null" >
                member_info_checking,
            </if>
            <if test="familyRecordSummary != null" >
                family_record_summary,
            </if>
            <if test="assetChecking != null" >
                asset_checking,
            </if>
            <if test="asset != null" >
                asset,
            </if>
            <if test="type != null" >
                type,
            </if>
            <if test="orderStatus != null" >
                order_status,
            </if>
            <if test="channel != null" >
                channel,
            </if>
            <if test="lenderId != null" >
                lender_id,
            </if>
            <if test="reportId != null" >
                report_id,
            </if>
            <if test="operUserId != null" >
                oper_user_id,
            </if>
            <if test="isDeleted != null" >
                IS_DELETED,
            </if>
            <if test="creOperId != null" >
                CRE_OPER_ID,
            </if>
            <if test="creOperName != null" >
                CRE_OPER_NAME,
            </if>
            <if test="creOrgId != null" >
                CRE_ORG_ID,
            </if>
            <if test="creDate != null" >
                CRE_DATE,
            </if>
            <if test="updOperId != null" >
                UPD_OPER_ID,
            </if>
            <if test="updOperName != null" >
                UPD_OPER_NAME,
            </if>
            <if test="updOrgId != null" >
                UPD_ORG_ID,
            </if>
            <if test="updDate != null" >
                UPD_DATE,
            </if>
            <if test="productSettlePrice != null" >
                product_settle_price,
            </if>
            <if test="productPrice != null" >
                product_price,
            </if>
            <if test="productListInfo != null" >
                product_list_info,
            </if>
            <if test="recieveNongZi != null" >
                recieve_nong_zi,
            </if>
            <if test="recieveCash != null" >
                recieve_cash,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="modelId != null" >
                #{modelId,jdbcType=VARCHAR},
            </if>
            <if test="orgId != null" >
                #{orgId,jdbcType=VARCHAR},
            </if>
            <if test="product != null" >
                #{product,jdbcType=VARCHAR},
            </if>
            <if test="name != null" >
                #{name,jdbcType=VARCHAR},
            </if>
            <if test="creditCapital != null" >
                #{creditCapital,jdbcType=DECIMAL},
            </if>
            <if test="capital != null" >
                #{capital,jdbcType=DECIMAL},
            </if>
            <if test="term != null" >
                #{term,jdbcType=INTEGER},
            </if>
            <if test="use != null" >
                #{use,jdbcType=INTEGER},
            </if>
            <if test="useRemark != null" >
                #{useRemark,jdbcType=VARCHAR},
            </if>
            <if test="memberId != null" >
                #{memberId,jdbcType=VARCHAR},
            </if>
            <if test="memberName != null" >
                #{memberName,jdbcType=VARCHAR},
            </if>
            <if test="sex != null" >
                #{sex,jdbcType=INTEGER},
            </if>
            <if test="age != null" >
                #{age,jdbcType=INTEGER},
            </if>
            <if test="idCard != null" >
                #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="phone != null" >
                #{phone,jdbcType=VARCHAR},
            </if>
            <if test="bank != null" >
                #{bank,jdbcType=VARCHAR},
            </if>
            <if test="bankCardNo != null" >
                #{bankCardNo,jdbcType=VARCHAR},
            </if>
            <if test="address != null" >
                #{address,jdbcType=VARCHAR},
            </if>
            <if test="educationLevel != null" >
                #{educationLevel,jdbcType=INTEGER},
            </if>
            <if test="maritalStatus != null" >
                #{maritalStatus,jdbcType=INTEGER},
            </if>
            <if test="duty != null" >
                #{duty,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComName != null" >
                #{nonfarmComName,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComAddress != null" >
                #{nonfarmComAddress,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComPhone != null" >
                #{nonfarmComPhone,jdbcType=VARCHAR},
            </if>
            <if test="trialBy != null" >
                #{trialBy,jdbcType=VARCHAR},
            </if>
            <if test="trialName != null" >
                #{trialName,jdbcType=VARCHAR},
            </if>
            <if test="trialDate != null" >
                #{trialDate,jdbcType=TIMESTAMP},
            </if>
            <if test="trialOpinion != null" >
                #{trialOpinion,jdbcType=VARCHAR},
            </if>
            <if test="reviewBy != null" >
                #{reviewBy,jdbcType=VARCHAR},
            </if>
            <if test="reviewName != null" >
                #{reviewName,jdbcType=VARCHAR},
            </if>
            <if test="reviewDate != null" >
                #{reviewDate,jdbcType=TIMESTAMP},
            </if>
            <if test="reviewOpinion != null" >
                #{reviewOpinion,jdbcType=VARCHAR},
            </if>
            <if test="lastBy != null" >
                #{lastBy,jdbcType=VARCHAR},
            </if>
            <if test="lastName != null" >
                #{lastName,jdbcType=VARCHAR},
            </if>
            <if test="lastDate != null" >
                #{lastDate,jdbcType=TIMESTAMP},
            </if>
            <if test="lastOpinion != null" >
                #{lastOpinion,jdbcType=VARCHAR},
            </if>
            
            <if test="serviceFeeWay != null" >
                #{serviceFeeWay,jdbcType=INTEGER},
            </if>
            <if test="memberInfoChecking != null" >
                #{memberInfoChecking,jdbcType=INTEGER},
            </if>
            <if test="familyRecordSummary != null" >
                #{familyRecordSummary,jdbcType=VARCHAR},
            </if>
            <if test="assetChecking != null" >
                #{assetChecking,jdbcType=VARCHAR},
            </if>
            <if test="asset != null" >
                #{asset,jdbcType=VARCHAR},
            </if>
            <if test="type != null" >
                #{type,jdbcType=INTEGER},
            </if>
            <if test="orderStatus != null" >
                #{orderStatus,jdbcType=INTEGER},
            </if>
            <if test="channel != null" >
                #{channel,jdbcType=VARCHAR},
            </if>
            <if test="lenderId != null" >
                #{lenderId,jdbcType=VARCHAR},
            </if>
            <if test="reportId != null" >
                #{reportId,jdbcType=VARCHAR},
            </if>
            <if test="operUserId != null" >
                #{operUserId,jdbcType=VARCHAR},
            </if>
            <if test="isDeleted != null" >
                #{isDeleted,jdbcType=TINYINT},
            </if>
            <if test="creOperId != null" >
                #{creOperId,jdbcType=VARCHAR},
            </if>
            <if test="creOperName != null" >
                #{creOperName,jdbcType=VARCHAR},
            </if>
            <if test="creOrgId != null" >
                #{creOrgId,jdbcType=VARCHAR},
            </if>
            <if test="creDate != null" >
                #{creDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updOperId != null" >
                #{updOperId,jdbcType=VARCHAR},
            </if>
            <if test="updOperName != null" >
                #{updOperName,jdbcType=VARCHAR},
            </if>
            <if test="updOrgId != null" >
                #{updOrgId,jdbcType=VARCHAR},
            </if>
            <if test="updDate != null" >
                #{updDate,jdbcType=TIMESTAMP},
            </if>
            <if test="productSettlePrice != null" >
                #{productSettlePrice,jdbcType=VARCHAR},
            </if>
            <if test="productPrice != null" >
                #{productPrice,jdbcType=VARCHAR},
            </if>
            <if test="productListInfo != null" >
                #{productListInfo,jdbcType=LONGVARCHAR},
            </if>
            <if test="recieveNongZi != null" >
                #{recieveNongZi,jdbcType=VARCHAR},
            </if>
            <if test="recieveCash != null" >
                #{recieveCash,jdbcType=VARCHAR},
            </if>
        </trim>
        
    </insert>

    <update id="updateByPrimaryKeySelective" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        update t_bus_intopiece
        <set >
            <if test="modelId != null" >
                model_id = #{modelId,jdbcType=VARCHAR},
            </if>
            <if test="orgId != null" >
                org_id = #{orgId,jdbcType=VARCHAR},
            </if>
            <if test="product != null" >
                product = #{product,jdbcType=VARCHAR},
            </if>
            <if test="name != null" >
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="creditCapital != null" >
                credit_capital = #{creditCapital,jdbcType=DECIMAL},
            </if>
            <if test="capital != null" >
                capital = #{capital,jdbcType=DECIMAL},
            </if>
            <if test="term != null" >
                term = #{term,jdbcType=INTEGER},
            </if>
            <if test="use != null" >
                `use` = #{use,jdbcType=INTEGER},
            </if>
            <if test="useRemark != null" >
                use_remark = #{useRemark,jdbcType=VARCHAR},
            </if>
            <if test="memberId != null" >
                member_id = #{memberId,jdbcType=VARCHAR},
            </if>
            <if test="memberName != null" >
                member_name = #{memberName,jdbcType=VARCHAR},
            </if>
            <if test="sex != null" >
                sex = #{sex,jdbcType=INTEGER},
            </if>
            <if test="age != null" >
                age = #{age,jdbcType=INTEGER},
            </if>
            <if test="idCard != null" >
                id_card = #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="phone != null" >
                phone = #{phone,jdbcType=VARCHAR},
            </if>
            <if test="bank != null" >
                bank = #{bank,jdbcType=VARCHAR},
            </if>
            <if test="bankCardNo != null" >
                bank_card_no = #{bankCardNo,jdbcType=VARCHAR},
            </if>
            <if test="address != null" >
                address = #{address,jdbcType=VARCHAR},
            </if>
            <if test="educationLevel != null" >
                education_level = #{educationLevel,jdbcType=INTEGER},
            </if>
            <if test="maritalStatus != null" >
                marital_status = #{maritalStatus,jdbcType=INTEGER},
            </if>
            <if test="duty != null" >
                duty = #{duty,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComName != null" >
                nonfarm_com_name = #{nonfarmComName,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComAddress != null" >
                nonfarm_com_address = #{nonfarmComAddress,jdbcType=VARCHAR},
            </if>
            <if test="nonfarmComPhone != null" >
                nonfarm_com_phone = #{nonfarmComPhone,jdbcType=VARCHAR},
            </if>
            <if test="trialBy != null" >
                trial_by = #{trialBy,jdbcType=VARCHAR},
            </if>
            <if test="trialName != null" >
                trial_name = #{trialName,jdbcType=VARCHAR},
            </if>
            <if test="trialDate != null" >
                trial_date = #{trialDate,jdbcType=TIMESTAMP},
            </if>
            <if test="trialOpinion != null" >
                trial_opinion = #{trialOpinion,jdbcType=VARCHAR},
            </if>
            <if test="reviewBy != null" >
                review_by = #{reviewBy,jdbcType=VARCHAR},
            </if>
            <if test="reviewName != null" >
                review_name = #{reviewName,jdbcType=VARCHAR},
            </if>
            <if test="reviewDate != null" >
                review_date = #{reviewDate,jdbcType=TIMESTAMP},
            </if>
            <if test="reviewOpinion != null" >
                review_opinion = #{reviewOpinion,jdbcType=VARCHAR},
            </if>
            <if test="lastBy != null" >
                last_by = #{lastBy,jdbcType=VARCHAR},
            </if>
            <if test="lastName != null" >
                last_name = #{lastName,jdbcType=VARCHAR},
            </if>
            <if test="lastDate != null" >
                last_date = #{lastDate,jdbcType=TIMESTAMP},
            </if>
            <if test="lastOpinion != null" >
                last_opinion = #{lastOpinion,jdbcType=VARCHAR},
            </if>
            <if test="serviceFeeWay != null" >
                service_fee_way = #{serviceFeeWay,jdbcType=INTEGER},
            </if>
            <if test="memberInfoChecking != null" >
                member_info_checking = #{memberInfoChecking,jdbcType=INTEGER},
            </if>
            <if test="familyRecordSummary != null" >
                family_record_summary = #{familyRecordSummary,jdbcType=VARCHAR},
            </if>
            <if test="assetChecking != null" >
                asset_checking = #{assetChecking,jdbcType=VARCHAR},
            </if>
            <if test="asset != null" >
                asset = #{asset,jdbcType=VARCHAR},
            </if>
            <if test="type != null" >
                type = #{type,jdbcType=INTEGER},
            </if>
            <if test="orderStatus != null" >
                order_status = #{orderStatus,jdbcType=INTEGER},
            </if>
            <if test="channel != null" >
                channel = #{channel,jdbcType=VARCHAR},
            </if>
            <if test="lenderId != null" >
                lender_id = #{lenderId,jdbcType=VARCHAR},
            </if>
            <if test="reportId != null" >
                report_id = #{reportId,jdbcType=VARCHAR},
            </if>
            <if test="operUserId != null" >
                oper_user_id = #{operUserId,jdbcType=VARCHAR},
            </if>
            <if test="isDeleted != null" >
                IS_DELETED = #{isDeleted,jdbcType=TINYINT},
            </if>
            <if test="creOperId != null" >
                CRE_OPER_ID = #{creOperId,jdbcType=VARCHAR},
            </if>
            <if test="creOperName != null" >
                CRE_OPER_NAME = #{creOperName,jdbcType=VARCHAR},
            </if>
            <if test="creOrgId != null" >
                CRE_ORG_ID = #{creOrgId,jdbcType=VARCHAR},
            </if>
            <if test="creDate != null" >
                CRE_DATE = #{creDate,jdbcType=TIMESTAMP},
            </if>
            <if test="updOperId != null" >
                UPD_OPER_ID = #{updOperId,jdbcType=VARCHAR},
            </if>
            <if test="updOperName != null" >
                UPD_OPER_NAME = #{updOperName,jdbcType=VARCHAR},
            </if>
            <if test="updOrgId != null" >
                UPD_ORG_ID = #{updOrgId,jdbcType=VARCHAR},
            </if>
            <if test="updDate != null" >
                UPD_DATE = #{updDate,jdbcType=TIMESTAMP},
            </if>
            <if test="productSettlePrice != null" >
                product_settle_price = #{productSettlePrice,jdbcType=VARCHAR},
            </if>
            <if test="productPrice != null" >
                product_price = #{productPrice,jdbcType=VARCHAR},
            </if>
            <if test="productListInfo != null" >
                product_list_info = #{productListInfo,jdbcType=LONGVARCHAR},
            </if>
            <if test="recieveNongZi != null" >
                recieve_nong_zi = #{recieveNongZi,jdbcType=VARCHAR},
            </if>
            <if test="recieveCash != null" >
                recieve_cash = #{recieveCash,jdbcType=VARCHAR},
            </if>
            
        </set>
        where id = #{id,jdbcType=VARCHAR}
    </update>

    <update id="updateByPrimaryKey" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        update t_bus_intopiece
        set model_id = #{modelId,jdbcType=VARCHAR},
            org_id = #{orgId,jdbcType=VARCHAR},
            product = #{product,jdbcType=VARCHAR},
            name = #{name,jdbcType=VARCHAR},
            credit_capital = #{creditCapital,jdbcType=DECIMAL},
            capital = #{capital,jdbcType=DECIMAL},
            term = #{term,jdbcType=INTEGER},
            `use` = #{use,jdbcType=INTEGER},
            use_remark = #{useRemark,jdbcType=VARCHAR},
            member_id = #{memberId,jdbcType=VARCHAR},
            member_name = #{memberName,jdbcType=VARCHAR},
            sex = #{sex,jdbcType=INTEGER},
            age = #{age,jdbcType=INTEGER},
            id_card = #{idCard,jdbcType=VARCHAR},
            phone = #{phone,jdbcType=VARCHAR},
            bank = #{bank,jdbcType=VARCHAR},
            bank_card_no = #{bankCardNo,jdbcType=VARCHAR},
            address = #{address,jdbcType=VARCHAR},
            education_level = #{educationLevel,jdbcType=INTEGER},
            marital_status = #{maritalStatus,jdbcType=INTEGER},
            duty = #{duty,jdbcType=VARCHAR},
            nonfarm_com_name = #{nonfarmComName,jdbcType=VARCHAR},
            nonfarm_com_address = #{nonfarmComAddress,jdbcType=VARCHAR},
            nonfarm_com_phone = #{nonfarmComPhone,jdbcType=VARCHAR},
            trial_by = #{trialBy,jdbcType=VARCHAR},
            trial_name = #{trialName,jdbcType=VARCHAR},
            trial_date = #{trialDate,jdbcType=TIMESTAMP},
            trial_opinion = #{trialOpinion,jdbcType=VARCHAR},
            review_by = #{reviewBy,jdbcType=VARCHAR},
            review_name = #{reviewName,jdbcType=VARCHAR},
            review_date = #{reviewDate,jdbcType=TIMESTAMP},
            review_opinion = #{reviewOpinion,jdbcType=VARCHAR},
            last_by = #{lastBy,jdbcType=VARCHAR},
            last_name = #{lastName,jdbcType=VARCHAR},
            last_date = #{lastDate,jdbcType=TIMESTAMP},
            last_opinion = #{lastOpinion,jdbcType=VARCHAR},
            service_fee_way = #{serviceFeeWay,jdbcType=INTEGER},
            member_info_checking = #{memberInfoChecking,jdbcType=INTEGER},
            family_record_summary = #{familyRecordSummary,jdbcType=VARCHAR},
            asset_checking = #{assetChecking,jdbcType=VARCHAR},
            asset = #{asset,jdbcType=VARCHAR},
            type = #{type,jdbcType=INTEGER},
            order_status = #{orderStatus,jdbcType=INTEGER},
            channel = #{channel,jdbcType=VARCHAR},
            lender_id = #{lenderId,jdbcType=VARCHAR},
            report_id = #{reportId,jdbcType=VARCHAR},
            oper_user_id = #{operUserId,jdbcType=VARCHAR},
            IS_DELETED = #{isDeleted,jdbcType=TINYINT},
            CRE_OPER_ID = #{creOperId,jdbcType=VARCHAR},
            CRE_OPER_NAME = #{creOperName,jdbcType=VARCHAR},
            CRE_ORG_ID = #{creOrgId,jdbcType=VARCHAR},
            CRE_DATE = #{creDate,jdbcType=TIMESTAMP},
            UPD_OPER_ID = #{updOperId,jdbcType=VARCHAR},
            UPD_OPER_NAME = #{updOperName,jdbcType=VARCHAR},
            UPD_ORG_ID = #{updOrgId,jdbcType=VARCHAR},
            UPD_DATE = #{updDate,jdbcType=TIMESTAMP},
            product_settle_price = #{productSettlePrice,jdbcType=VARCHAR},
            product_price = #{productPrice,jdbcType=VARCHAR},
            product_list_info = #{productListInfo,jdbcType=LONGVARCHAR},
            recieve_nong_zi=#{recieveNongZi,jdbcType=VARCHAR},
            recieve_cash=#{recieveCash,jdbcType=VARCHAR}
        where id = #{id,jdbcType=VARCHAR}
    </update>
    
    <!-- 手写 -->
    <resultMap id="intoPieceMap" type="com.nongyeos.loan.admin.resultMap.IntoPieceMap" extends="BaseResultMap">
    	<result column="status" property="status" jdbcType="VARCHAR" />
    	<result column="full_cname" property="fullCname" jdbcType="VARCHAR" />
    	<result column="status_update" property="statusUpdate" jdbcType="TIMESTAMP" />
    	<result column="yyyymmdd" property="yyyymmdd" jdbcType="VARCHAR" />
    	<result column="total" property="total" jdbcType="INTEGER" />
    	<result column="person_id" property="personId" jdbcType="VARCHAR" />
    	<result column="NAME_CN" property="operName" jdbcType="VARCHAR" />
    	<result column="app_name" property="appName" jdbcType="VARCHAR" />
    	<result column="service_status" property="serviceStatus" jdbcType="VARCHAR" />
    	<result column="fins_id" property="finsId" jdbcType="VARCHAR" />
    </resultMap>
    <select id="selectCountByCondition" resultType="java.lang.Integer" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        select 
        count(ip.id)
        from t_bus_intopiece ip left join t_sys_org org on ip.org_id = org.org_id left join t_app_entry ae on ip.id = ae.mode_id
        where 1=1 
        <if test="isDeleted != null" >
             and ip.IS_DELETED = #{isDeleted,jdbcType=TINYINT}
        </if>
        <if test="fullCname != null" >
             and org.full_cname like CONCAT('%',#{fullCname},'%')
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
         </if>
         <if test="idCard != null" >
             and ip.id_card like CONCAT('%',#{idCard},'%')
         </if>
         <if test="phone != null" >
             and ip.phone like CONCAT('%',#{phone},'%')
         </if>
         <if test="use != null" >
             and ip.`use` = #{use,jdbcType=INTEGER}
         </if>
         <if test="capital != null" >
             and ip.capital = #{capital,jdbcType=DECIMAL}
         </if>
         <if test="appName != null" >
             and ae.app_name like CONCAT('%',#{appName},'%')
         </if>
         <if test="status != null" >
             and ae.node_name = #{status,jdbcType=VARCHAR}
         </if>
         <if test="personId != null" >
             and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR})
         </if>
         <if test="startDate != null" >
             and ip.CRE_DATE &gt; #{startDate,jdbcType=VARCHAR}
         </if>
         <if test="endDate != null" >
             and ip.CRE_DATE &lt; #{endDate,jdbcType=VARCHAR}
         </if>
    </select>
    
    <select id="selectByCondition" resultMap="intoPieceMap" parameterType="com.nongyeos.loan.admin.resultMap.IntoPieceMap" >
        select 
        ip.*,ae.node_name status,org.full_cname,g.status service_status,p.NAME_CN,ae.app_name,ae.fins_id
        from t_bus_intopiece ip left join t_sys_org org on ip.org_id = org.org_id left join t_app_entry ae on ip.id = ae.mode_id left join
         t_sys_person p on ip.oper_user_id = p.PERSON_ID left join t_bus_guaranteefeeinfo g on g.into_piece_id = ip.id
        where 1=1 
        <if test="isDeleted != null" >
             and ip.IS_DELETED = #{isDeleted,jdbcType=TINYINT}
        </if>
        <if test="fullCname != null" >
             and org.full_cname like CONCAT('%',#{fullCname},'%')
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
         </if>
         <if test="idCard != null" >
             and ip.id_card like CONCAT('%',#{idCard},'%')
         </if>
         <if test="phone != null" >
             and ip.phone like CONCAT('%',#{phone},'%')
         </if>
         <if test="use != null" >
             and ip.`use` = #{use,jdbcType=INTEGER}
         </if>
         <if test="capital != null" >
             and ip.capital = #{capital,jdbcType=DECIMAL}
         </if>
         <if test="appName != null" >
             and ae.app_name like CONCAT('%',#{appName},'%')
         </if>
         <if test="status != null" >
             and ae.node_name = #{status,jdbcType=VARCHAR}
         </if>
         <if test="personId != null" >
             and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR})
         </if>
          <if test="startDate != null" >
             and ip.CRE_DATE &gt; #{startDate,jdbcType=VARCHAR}
         </if>
         <if test="endDate != null" >
             and ip.CRE_DATE &lt; #{endDate,jdbcType=VARCHAR}
         </if>
         order by ip.CRE_DATE desc
    </select>
    <select id="selectCountByMemberLoginId" resultType="java.lang.Integer" parameterType="hashmap" >
        select count(ip.id)  from t_bus_intopiece ip LEFT JOIN t_bus_member m ON 
        ip.member_id=m.MEMBER_ID LEFT JOIN t_bus_memberlogin ml ON ml.MEMBER_ID=m.MEMBER_ID LEFT JOIN 
        t_app_entry  ae ON ae.MODE_ID=ip.id  
        where 1=1 
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
         </if>
        <if test="loginId != null" >
             and ml.LOGIN_ID = #{loginId,jdbcType=TINYINT}
        </if>
        <if test="channel != null" >
             and ip.channel = #{channel,jdbcType=VARCHAR}
        </if>
        <if test="status != null" >
             and ae.NODE_NAME IN
            <foreach item="status" index="index" collection="status"
                open="(" separator="," close=")"> #{status}
            </foreach>
         </if>
    </select>
    
    <select id="selectByMemberLoginId" resultMap="intoPieceMap" parameterType="hashmap" >
        select ip.*,org.full_cname,ae.NODE_NAME status ,ae.UPD_DATE status_update  from t_bus_intopiece ip LEFT JOIN t_bus_member m ON 
        ip.member_id=m.MEMBER_ID LEFT JOIN t_bus_memberlogin ml ON ml.MEMBER_ID=m.MEMBER_ID LEFT JOIN 
        t_app_entry  ae ON ae.MODE_ID=ip.id  left join t_sys_org org on ip.org_id = org.org_id
        where 1=1 
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
         </if>
        <if test="loginId != null" >
             and ml.LOGIN_ID = #{loginId,jdbcType=TINYINT}
        </if>
        <if test="channel != null" >
             and ip.channel = #{channel,jdbcType=VARCHAR}
        </if>
        <if test="date != null" >
             and ae.UPD_DATE > #{date}
        </if>
        <if test="status != null" >
             and ae.NODE_NAME IN
            <foreach item="status" index="index" collection="status"
                open="(" separator="," close=")"> #{status}
            </foreach>
         </if>
        ORDER BY ip.CRE_DATE desc
    </select>
    
    <select id="selectFirstIdCardAndOrg" resultMap="intoPieceMap" parameterType="com.nongyeos.loan.admin.entity.BusIntoPiece" >
        select 
        id
        from t_bus_intopiece 
        where 1=1 
        <if test="isDeleted != null" >
             and IS_DELETED = #{isDeleted,jdbcType=TINYINT}
        </if>
        <if test="orgId != null" >
             and org_id like "%"#{orgId,jdbcType=VARCHAR}"%"
         </if>
         <if test="idCard != null" >
             and id_card =#{idCard,jdbcType=VARCHAR}
         </if>
         order by CRE_DATE desc limit 0,1
    </select>
    <!-- 根据审核状态及部门查询进件 -->
    <select id="selectByOrgIds" resultMap="intoPieceMap" parameterType="hashmap" >
        select ip.*,org.full_cname,ae.NODE_NAME status ,ae.UPD_DATE status_update  from t_bus_intopiece ip LEFT JOIN t_bus_member m ON 
        ip.member_id=m.MEMBER_ID LEFT JOIN t_bus_memberlogin ml ON ml.MEMBER_ID=m.MEMBER_ID LEFT JOIN 
        t_app_entry  ae ON ae.MODE_ID=ip.id  left join t_sys_org org on ip.org_id = org.org_id
        where 1=1 
        <if test="orgId != null" >
             and ip.org_id IN
            <foreach item="orgId" index="index" collection="orgId"
                open="(" separator="," close=")"> #{orgId}
            </foreach>
         </if>
        <if test="isDeleted != null" >
             and ip.IS_DELETED = #{isDeleted,jdbcType=TINYINT}
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
        </if>
        <if test="date != null" >
             and ae.UPD_DATE > #{date}
        </if>
        <if test="status != null" >
             and ae.NODE_NAME IN
            <foreach item="status" index="index" collection="status"
                open="(" separator="," close=")"> #{status}
            </foreach>
         </if>
        ORDER BY ae.CRE_DATE desc
    </select>
    <select id="selectCountByOrgIds" resultType="java.lang.Integer" parameterType="hashmap" >
        select count(ip.id) from t_bus_intopiece ip LEFT JOIN t_bus_member m ON 
        ip.member_id=m.MEMBER_ID LEFT JOIN t_bus_memberlogin ml ON ml.MEMBER_ID=m.MEMBER_ID LEFT JOIN 
        t_app_entry  ae ON ae.MODE_ID=ip.id  left join t_sys_org org on ip.org_id = org.org_id
        where 1=1 
        <if test="orgId != null" >
             and ip.org_id IN
            <foreach item="orgId" index="index" collection="orgId"
                open="(" separator="," close=")"> #{orgId}
            </foreach>
         </if>
        <if test="isDeleted != null" >
             and ip.IS_DELETED = #{isDeleted,jdbcType=TINYINT}
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
        </if>
        <if test="date != null" >
             and ae.UPD_DATE > #{date}
        </if>
        <if test="status != null" >
             and ae.NODE_NAME IN
            <foreach item="status" index="index" collection="status"
                open="(" separator="," close=")"> #{status}
            </foreach>
         </if>
    </select>
    
    <select id="selectByMemberId" resultMap="BaseResultMap" parameterType="java.lang.String" >
        select 
        <include refid="Base_Column_List" />
        from t_bus_intopiece
        where member_id = #{memberId,jdbcType=VARCHAR} and IS_DELETED = 0 order by CRE_DATE desc
    </select>
    
    <select id="selectExportMap" resultMap="ExportResultMap" parameterType="java.lang.String" >
        SELECT l.repayment_type,l.term,l.capital,ip.member_name,ip.sex,ip.age,ip.id,ip.id_card,
        ip.phone,ip.address,ip.bank,ip.bank_card_no,ip.use_remark,ip.review_opinion,
        ip.education_level,ip.marital_status,ip.credit_capital from t_bus_loan l LEFT JOIN 
        t_bus_intopiece ip on ip.id=l.into_piece_id  where ip.id=#{intopieceId,jdbcType=VARCHAR}
    </select> 
    
    <select id="selectByHistory" resultMap="intoPieceMap" parameterType="hashmap" >
        select ip.*,org.full_cname,ae.NODE_NAME status ,ae.CRE_DATE status_update  from t_bus_intopiece ip LEFT JOIN t_bus_member m ON 
        ip.member_id=m.MEMBER_ID  LEFT JOIN 
        t_app_entry  ae ON ae.MODE_ID=ip.id  left join t_sys_org org on ip.org_id = org.org_id
        where 1=1 and ip.IS_DELETED = 0
        <if test="idCard != null" >
             and m.id_card =#{idCard,jdbcType=VARCHAR}
         </if>
        <if test="orgId != null" >
             and ip.org_id =#{orgId,jdbcType=VARCHAR}
         </if>
        <if test="status != null" >
             and ae.NODE_NAME IN
            <foreach item="status" index="index" collection="status"
                open="(" separator="," close=")"> #{status}
            </foreach>
         </if>
        ORDER BY ip.CRE_DATE desc
    </select>
    <select id="weekIpStatistics" resultMap="intoPieceMap" parameterType="hashmap" >
        SELECT DATE_FORMAT(CRE_DATE,'%Y-%m-%d') yyyymmdd,count(0) total
        from t_bus_intopiece 
        where CRE_DATE >  #{yyyymmdd,jdbcType=VARCHAR} and org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR}) GROUP BY yyyymmdd
    </select>
    <select id="weekMoneyStatistics" resultMap="intoPieceMap" parameterType="hashmap" >
        SELECT DATE_FORMAT(ml.UPD_DATE,'%Y-%m-%d') yyyymmdd,sum(ml.capital) capital
        from t_bus_moneylog ml LEFT JOIN t_bus_loan l on ml.loan_id = l.id LEFT JOIN t_bus_intopiece ip on l.into_piece_id = ip.id 
        where ml.UPD_DATE > #{yyyymmdd,jdbcType=VARCHAR} and ml.type = 1 and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR}) GROUP BY yyyymmdd
    </select>
    <select id="todayCreCount" resultType="java.lang.Integer" parameterType="hashmap" >
        SELECT
		count(0) total
		from t_bus_intopiece 
		where org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR}) and CRE_DATE > #{yyyymmdd,jdbcType=VARCHAR}
    </select>
    <select id="todayMoneyToMember" resultMap="BaseResultMap" parameterType="hashmap" >
        SELECT ml.capital
        from t_bus_moneylog ml LEFT JOIN t_bus_loan l on ml.loan_id = l.id LEFT JOIN t_bus_intopiece ip on l.into_piece_id = ip.id 
        where ml.UPD_DATE > #{yyyymmdd,jdbcType=VARCHAR} and ml.type = 1 and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR})
    </select>
    <select id="selectRepayXlsx" resultType="java.lang.String" parameterType="hashmap" >
        select 
        ip.id
        from t_bus_intopiece ip left join t_app_entry ae on ip.id = ae.mode_id
        where ip.member_name = #{memberName,jdbcType=VARCHAR} and ip.id_card = #{idCard,jdbcType=VARCHAR} and ae.fins_id = #{finsId,jdbcType=VARCHAR} and ip.IS_DELETED = 0 and ae.node_name= '10'
    </select>
    <!-- 购买农资进件 -->
    <select id="queryNongZi" resultMap="BaseResultMap" parameterType="hashmap" >
        select 
        ip.id,org.full_cname as org_id,ip.member_name,ip.id_card,ip.capital,l.recieve_nong_zi,l.recieve_cash
        from t_bus_intopiece ip left join t_sys_org org on ip.org_id = org.org_id left join t_bus_loan l on ip.id = l.into_piece_id 
        where ip.IS_DELETED = 0 and ip.type in ('2','3')
        <if test="orderStatus != null" >
             and ip.order_status = #{orderStatus,jdbcType=INTEGER}
        </if>
        <if test="fullCname != null" >
             and org.full_cname like CONCAT('%',#{fullCname},'%')
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
        </if>
        <if test="idCard != null" >
            and ip.id_card like CONCAT('%',#{idCard},'%')
        </if>
        <if test="personId != null" >
            and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR})
        </if>
        order by ip.CRE_DATE desc
    </select>
    <select id="queryCountNongZi" resultType="java.lang.Integer" parameterType="hashmap" >
        select 
        count(ip.id)
        from t_bus_intopiece ip left join t_sys_org org on ip.org_id = org.org_id
        where ip.IS_DELETED = 0 and ip.type in ('2','3')
        <if test="orderStatus != null" >
             and ip.order_status = #{orderStatus,jdbcType=INTEGER}
        </if>
        <if test="fullCname != null" >
             and org.full_cname like CONCAT('%',#{fullCname},'%')
        </if>
        <if test="memberName != null" >
             and ip.member_name like CONCAT('%',#{memberName},'%')
        </if>
        <if test="idCard != null" >
            and ip.id_card like CONCAT('%',#{idCard},'%')
        </if>
        <if test="personId != null" >
            and ip.org_id in (select org_id from t_sys_personorg where PERSON_ID = #{personId,jdbcType=VARCHAR})
        </if>
    </select>
</mapper>
